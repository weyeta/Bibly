<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lector de Códigos de Barras</title>
  <script src="https://unpkg.com/@zxing/browser@latest"></script>
</head>
<body>
  <h1>Escanear Código</h1>
  <video id="video" width="300" height="200" style="border: 1px solid gray"></video>
  <p>Resultado: <span id="result"></span></p>

  <script>
    window.addEventListener('DOMContentLoaded', async () => {
      const video = document.getElementById('video');
      const resultText = document.getElementById('result');

      try {
        const devices = await ZXing.BrowserMultiFormatReader.listVideoInputDevices();

        if (devices.length === 0) {
          alert("No se detectaron cámaras.");
          return;
        }

        const selectedDeviceId = devices[0].deviceId;

        const codeReader = new ZXing.BrowserMultiFormatReader();
        await codeReader.decodeFromVideoDevice(selectedDeviceId, video, (result, error) => {
          if (result) {
            resultText.textContent = result.getText();
          }
        });

        console.log("Escaneo iniciado.");
      } catch (error) {
        console.error("Error al acceder a la cámara:", error);
        alert("No se pudo acceder a la cámara. Asegurate de que el navegador tenga permisos.");
      }
    });
  </script>
</body>
</html>
